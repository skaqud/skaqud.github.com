<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      자주 사용하는 명령들 &middot; 雜夫's Blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/toc.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-81856790-1', 'auto');
    ga('send', 'pageview');

  </script>
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><BR><BR></p>
    <p>아키텍트==雜夫</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/tags/">Tags</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/tags2/">Tag=reuse</a>
        
      
    
      
    
      
    

    <!--a class="sidebar-nav-item" href="https://github.com/skaqud/archive/">Archive</a>
    <a class="sidebar-nav-item" href="https://github.com/skaqud/tags/">Tags</a-->
    <!--a class="sidebar-nav-item" href="https://github.com/skaqud">GitHub project</a-->
    <!--span class="sidebar-nav-item">Currently v0.0.1</span-->
  </nav>

  <div class="sidebar-item">
    <p>
      A reserved <a href="http://jekyllrb.com" target="_blank">Jekyll</a>, hosted on <a href="https://pages.github.com" target="_blank">Github Pages</a>. Theme is from <a href="https://github.com/poole/lanyon" target="_blank">@lanyon</a>.
    </p>
    <!--p>
      &copy; 2016. All rights reserved.
    </p-->
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">雜夫's Blog</a>
            <small>development architecture integration operation</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">자주 사용하는 명령들</h1>
  <span class="post-date">24 Jul 2016</span>
  <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#tocAnchor-1-1"><span class="tocnumber">1</span> <span class="toctext">Linux</span></a>
              <ul>
                <li class="toc_level-2 toc_section-2">
                  <a href="#tocAnchor-1-1-1"><span class="tocnumber">1.1</span> <span class="toctext">자주쓰는명령들</span></a>
                </li>
                <li class="toc_level-2 toc_section-3">
                  <a href="#tocAnchor-1-1-2"><span class="tocnumber">1.2</span> <span class="toctext">참고가 될 Shell Script</span></a>
                </li>
                <li class="toc_level-2 toc_section-4">
                  <a href="#tocAnchor-1-1-3"><span class="tocnumber">1.3</span> <span class="toctext">상황별 해결방법</span></a>
                </li>
                <li class="toc_level-2 toc_section-5">
                  <a href="#tocAnchor-1-1-4"><span class="tocnumber">1.4</span> <span class="toctext">운영시 유용한 명령들</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-6">
              <a href="#tocAnchor-1-6"><span class="tocnumber">2</span> <span class="toctext">그밖의 도구들</span></a>
              <ul>
                <li class="toc_level-2 toc_section-7">
                  <a href="#tocAnchor-1-6-1"><span class="tocnumber">2.1</span> <span class="toctext">Docker</span></a>
                </li>
                <li class="toc_level-2 toc_section-8">
                  <a href="#tocAnchor-1-6-2"><span class="tocnumber">2.2</span> <span class="toctext">GIT</span></a>
                </li>
                <li class="toc_level-2 toc_section-9">
                  <a href="#tocAnchor-1-6-3"><span class="tocnumber">2.3</span> <span class="toctext">MySQL</span></a>
                </li>
                <li class="toc_level-2 toc_section-10">
                  <a href="#tocAnchor-1-6-4"><span class="tocnumber">2.4</span> <span class="toctext">JDK</span></a>
                </li>
                <li class="toc_level-2 toc_section-11">
                  <a href="#tocAnchor-1-6-5"><span class="tocnumber">2.5</span> <span class="toctext">Python</span></a>
                </li>
                <li class="toc_level-2 toc_section-12">
                  <a href="#tocAnchor-1-6-6"><span class="tocnumber">2.6</span> <span class="toctext">Screen 명령정리</span></a>
                </li>
                <li class="toc_level-2 toc_section-13">
                  <a href="#tocAnchor-1-6-7"><span class="tocnumber">2.7</span> <span class="toctext">Proxy 설정</span></a>
                </li>
              </ul>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><p>자주 사용하는 명령들의 모음</p>

<h1 id="tocAnchor-1-1">Linux</h1>

<h2 id="tocAnchor-1-1-1">자주쓰는명령들</h2>

<h3 id="tar">tar명령</h3>

<p>tar.gz, tgz 등은 단순히 묶을 때 czvf, 풀때 xzvf 만 기억하면 될 듯</p>

<div class="highlighter-rouge"><pre class="highlight"><code>c : 압축
z : tar 압축후 gzip압축
v : verbose 압축과정을 출력
p : 소유권등 퍼미션을 그대로 유지
f : 내가 지정한 파일명으로 압축
압축하기
tar czvpf filename.tar.gz public_html/
압축풀기
tar xzvpf filename.tar.gz public_html/
</code></pre>
</div>

<h3 id="find">find명령</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>#find공백이 들어간 파일명 검색
find ./ -name "* *"
# 수정한지 20일 이상된 파일만 삭제 ( -exec rm {} \; )
find . -mtime +20 -type f -ls -exec rm {} \;
# 확장자가 .htm* .gif, .js, .css 인 것만 퍼미션을 644(rw-r--r--)로
find . -name "*.htm*" -o -name "*.gif" -o -name "*.js" -o -name "*.css" -exec chmod 644 {} \;
# 파일 크기가 300KB 이상( -size +300k )인 파일만
find . -size +300k -ls
#*..
</code></pre>
</div>

<h3 id="awkxargs-">awk,xargs 명령</h3>

<p>awk, xargs등의 명령은 ps, netstat 등과 연결하여 현재 떠있는 프로세스ID를 알아내거나, 그 프로세스들에 특정 작업을 하는 등 운영작업에 많이 사용됨.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#특정 user의 process를 무조건 kill하는 명령
ps -ef | grep user | awk '{print($1)}' | xargs kill -9
#구분자를 :로 하여 첫번째 필드를 출력
awk ‘FS=”:” {print $1}’ /etc/passwd
</code></pre>
</div>

<p>xargs는 표준 입력을 통해 명령 줄을 만들고 실행함. 너무 긴 명령행을 방지하기 위해 사용</p>

<h2 id="tocAnchor-1-1-2">참고가 될 Shell Script</h2>

<div class="highlighter-rouge"><pre class="highlight"><code># Mysql service up check
while [ `netstat -an | grep 3306 | wc -l` -eq 0 ]
do
        echo "Wating for Mysql start up"
        sleep 3;
done
echo "Mysql is UP!"

# Postgresql service up check
while [ `netstat -an | grep 5432 | wc -l` -eq 0 ]
do
        echo "Wating for Postgresql start up"
        sleep 3;
done
echo "Postgresql is UP!"
</code></pre>
</div>

<h2 id="tocAnchor-1-1-3">상황별 해결방법</h2>

<p>참고 - <a href="https://opentutorials.org/module/432/3742">생활코딩:SSH Key-비밀번호 없이 로그인</a></p>

<p>SSH로그인자동화(공개키를 이용한)</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#키 생성-rsa알고리즘으로 생성한다는 의미
ssh-keygen -t rsa
#타겟 서버로 복사
scp ~/.ssh/id_rsa.pub vagrant@192.168.33.12:
#혹은 다음과 같이 복사함.
ssh-copy-id vagrant@192.168.33.12
#해당 서버에 접속하여 허용 키 목록에 등록
cat ~/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
#권한 설정
chmod 700 ~/.ssh
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub  
chmod 644 ~/.ssh/authorized_keys
chmod 644 ~/.ssh/known_hosts
#위의 작업을 해 준 계정에만 해당됨.(위에서는 vagrant)
</code></pre>
</div>

<p>OS 버전 확인</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#ubuntu
#보안상의 이유로 바뀌어 있는 경우가 있음
cat /etc/issue
#그럴 경우 아래와 같이 수행
cat /etc/*release*
#혹은
lsb_release -a
</code></pre>
</div>

<p>저장소(Repository)서버 변경(ubuntu) - 기본적으로 설정되어 있는 repository의 경우 대부분 서버가 외국이라, 속도가 상당히 드린 편임, 아래와 같이 국내서버로 변경한다.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo vi /etc/apt/sources.list
:%s/archive.ubuntu.com/ftp.daumkakao.com/g
:%s/security.ubuntu.com/ftp.daumkakao.com/g
:%s/extras.ubuntu.com/ftp.daumkakao.com/g
apt-get update
</code></pre>
</div>

<p>시스템 시작시 자동으로 시작될 script</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/etc/rc.local 하위에 추가하면 됨
</code></pre>
</div>

<p>설치된 패키지 조회 및 제거</p>

<div class="highlighter-rouge"><pre class="highlight"><code>(ubuntu)

dpkg --get-selections | grep jdk

RPM명령(CentOS,RHEL계열)

#설치된 rpm 조회
rpm -qa | grep chef
#(위에서 이름을 확인 후)설치된 rpm 삭제
rpm -e chef-12.4.1-1.el7.x86_64
rpm 설치
rpm -ivh chef-12.5.1-1.el7.x86_64.rpm
rpm -Uvh chef-12.5.1-1.el7.x86_64.rpm
</code></pre>
</div>

<h2 id="tocAnchor-1-1-4">운영시 유용한 명령들</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>* 로그 크기 확인하기(일정 크기가 넘는 로그파일 확인)
du -k | awk '{if (length($1) &gt; 5) print}'
* 특정 계정에 속한 프로세스 kill 하기
ps -ef | grep 계정 | grep -v grep | awk '{print $2}' | xargs kill -9
</code></pre>
</div>

<h1 id="tocAnchor-1-6">그밖의 도구들</h1>

<h2 id="tocAnchor-1-6-1">Docker</h2>

<p>빌드</p>

<div class="highlighter-rouge"><pre class="highlight"><code>docker build -t ska/myapp:1.0 .
docker build -t ska/java_web:1.0 .
</code></pre>
</div>

<p>실행</p>

<div class="highlighter-rouge"><pre class="highlight"><code>docker run -d --name myapp -p 8080 ska/myapp:1.0
docker run -i --name myapp -t ska/myapp:1.0 /bin/bash
docker run -d --name java_web -p 8080 ska/java_web:1.0
docker run -i --name java_web -t ska/java_web:1.0 /bin/bash

#사용하지 않는 컨테이너 확인
docker ps -a | grep Exited | awk '{print $1}'
#사용하지 않는 컨테이너 전부 삭제
docker rm $(docker ps -a | grep Exited | awk '{print $1}')
#사용하지 않는 이미지 확인
docker images | grep none | awk '{print $3}'
#사용하지 않는 이미지 전부 삭제
docker rmi $(docker images | grep none | awk '{print $3}')
</code></pre>
</div>

<h2 id="tocAnchor-1-6-2">GIT</h2>

<h3 id="section-4">일반 명령</h3>

<div class="highlighter-rouge"><pre class="highlight"><code># 변경 반영 및 commit, push
git add --all
git add ./*
# gitifnore에 있으나, 무시하고 등록하고 싶을 경우
git add -f 파일명

git commit -a -m "commit message"
# push
git push origin master
# u옵션은 이후 push시 remote와 branch를 저장(이후로는 merge만 하면 됨)
git push -u origin master


#development 브랜치로 변경
git checkout development
# 브랜치 정보 보기
git branch
# 상태보기
git status

로컬에서 수정한 내용을 무시하고 싶을 때
git checkout -- 파일명

# 설정
</code></pre>
</div>

<h3 id="section-5">바이너리 파일 표시</h3>

<p>바이너리 파일의 경우 git에서 관리해줄 수 없는 포맷이라고 표시하는 게, git repository의 크기에도 좋고 관리에도 좋을 것 같음. 최상위 디렉토리에 .gitattributes 파일을 생성하고 다음과 같이 입력한다.</p>

<p>*.jpg binary</p>

<h3 id="gitignore-">gitignore 표시</h3>

<p>서버로 push 하지 않거나, 로컬로 다운로드가 필요하지 않은 파일의 경우(서버와 로컬이 설정이 달라야 할 경우) 최상위 디렉토리에 .gitignore 파일을 만들고 제외할 파일을 입력한다.</p>

<p>예로 C# project의 gitignore는 다음과 같음.</p>

<p>
  <a href="https://gist.github.com/kmorcinek/2710267">Example .gitignore file I use for C# projects</a>
</p>

<h3 id="section-6">설정</h3>

<p>git 설정은 로컬의 사용자 홈 디렉토리에 .gitconfig 라는 이름으로 저장됨. 파일을 직접 수정해도 되나, 정확히 format을 모르므로, 아래와 같이 명령어 사용하는 게 편함.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#글로벌 설정, email, username
git config --global user.name "...."
git config --global user.email ......

# 프록시 설정
git config http.proxy http://xx.xx.xx.xx:8888

# https verify false - 프록시 사용시 https 인증서 문제가 있다면 사용
git config http.sslVerify "false"
</code></pre>
</div>

<h2 id="tocAnchor-1-6-3">MySQL</h2>

<div class="highlighter-rouge"><pre class="highlight"><code># DB생성
CREATE SCHEMA ReviewDB DEFAULT CHARACTER SET utf8 ;
# 계정 생성
# MySQL은 접근시 모든호스트(%)로부터의 권한과 로컬(localhost)로부터의 권한을 별도로 줌
create user 'gerrit'@'%' identified by 'gerrit123';
grant all privileges on *.* to 'gerrit'@'%';
create user 'gerrit'@'localhost' identified by 'gerrit123';
grant all privileges on *.* to 'gerrit'@'localhost';
flush privileges;

Drop schema ReviewDB cascade;
</code></pre>
</div>

<h2 id="tocAnchor-1-6-4">JDK</h2>

<p>tar로 sun jdk 설치시 - apt-get 등으로는 sun-jdk를 바로 설치하기 좀 까다로움, 그래서 아래와 같이 tar를 특정위치에 풀고 update-alternatives 로 시스템에서 인식되도록 함.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget ......install_file_path/jdk-8u66-linux-x64.gz
tar zxvf jdk-8u66-linux-x64.gz

-ubuntu
update-alternatives --install /usr/bin/javac javac /opt/jdk1.8.0_66/bin/javac 1
update-alternatives --install /usr/bin/java java /opt/jdk1.8.0_66/bin/java 1
update-alternatives --install /usr/bin/javaws javaws /opt/jdk1.8.0_66/bin/javaws 1
</code></pre>
</div>

<h2 id="tocAnchor-1-6-5">Python</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>바로 활용할 수 있는 단순 웹 서버(보통 python은 다 설치되어 있음)
#run SimpleHTTPServer
python -m SimpleHTTPServer 8080
</code></pre>
</div>

<h2 id="tocAnchor-1-6-6">Screen 명령정리</h2>

<p>예전 터미널 상에서의 screen 명령보다는 tmux를 쓰거나 terminator 등 멀티화면 지원하는 ssh client를 쓰는 게 나음.
tmux의 경우 사용법이 그나마 간단하고, 별도의 GUI를 가지고 있지 않아서 터미널상에서 바로 쓸 수 있는 멀티Screen도구일 것 같음.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#설치
apt-get install tmux
#실행(실행시 아래 상태창이 생김)
tmux
# 새 창띄우기 - 순서대로 0부터 번호가 부여된 창이 생성됨
Ctrl+B 누르고 C
# 창 이동
Ctrl+B 누르고 숫자(화면번호)
# 같은 화면을 나눠서 쓸 경우
Ctrl+B 누르고 화살표
# 화면 나누기(가로)
Ctrl+B 누르고 =
# 화면 나누기(세로)
Ctrl+B 누르고 %
</code></pre>
</div>

<h2 id="tocAnchor-1-6-7">Proxy 설정</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>#env에 추가(wget,curl 등 cli 기반 도구의 경우)
export http_proxy="http://xx.xx.xx.xx:8888"
export https_proxy="http://xx.xx.xx.xx:8888"

#proxy setting(로그인쉘에 추가-bash의 경우)
echo 'export http_proxy="http://xx.xx.xx.xx:8888"' &gt;&gt; ~/.bash_profile
echo 'export https_proxy="https://xx.xx.xx.xx:8888"' &gt;&gt; ~/.bash_profile

#apt proxy setting(ubuntu 패키지 관리자)
echo 'Acquire::http::proxy "http://xx.xx.xx.xx:8888/";' &gt;&gt; /etc/apt/apt.conf
echo 'Acquire::https::proxy "http://xx.xx.xx.xx:8888/";' &gt;&gt; /etc/apt/apt.conf

#yum proxy setting(centos 패키지 관리자)
echo 'proxy=http://xx.xx.xx.xx:8888' &gt;&gt; /etc/yum.conf

#WINDOWS일 경우
set HTTP_PROXY="http://xx.xx.xx.xx:8888"
set HTTPS_PROXY="http://xx.xx.xx.xx:8888"

#git(gitconfig) 설정
git config http.proxy http://xx.xx.xx.xx:8888

#docker proxy 설정
참고 - http://nknu.net/running-docker-behind-a-proxy-on-ubuntu-14-04/

/etc/defaults/docker
파일 수정
export http_proxy="http://xx.xx.xx.xx:8888/"

### gpg proxy 설정
http-proxy="http://xx.xx.xx.xx:8888/"
home 디렉토리 하위 .gnupg/gpg.conf
아래와 같이 --keyserver-options 뒤에 넣습니다.
RUN gpg --keyserver hkp://keyserver.ubuntu.com:80 --keyserver-options http-proxy=http://xx.xx.xx.xx:8888 --recv-keys \

#android-sdk manager의 경우, 홈 디렉토리의 .android/androidtools.cfg 파일에 다음 내용 입력
http.proxyLogin=USER@PASSWORD
http.proxyPort=PORTNUMBER
http.proxyHost=PROXYHTTP
</code></pre>
</div>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h7>
          <a href="/2016/08/01/Make-Blog-with-Jekyll-on-Github-Pages/">
            Jekyll로 Github Page에 블로그만들기
            <small>01 Aug 2016</small>
          </a>
        </h7>
      </li>
    
      <li>
        <h7>
          <a href="/2016/07/25/Chromebook-linux-install-review/">
            크롬북 Crouton을 이용한 Linux 설치 사용기
            <small>25 Jul 2016</small>
          </a>
        </h7>
      </li>
    
      <li>
        <h7>
          <a href="/2016/04/26/make-devenv/">
            WEB,WAS,DB 설치 및 웹 어플리케이션 구성을 위해 연동하기
            <small>26 Apr 2016</small>
          </a>
        </h7>
      </li>
    
  </ul>
</div>

      </div>
    </div>

  </body>
</html>
